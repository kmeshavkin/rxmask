!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.rxmask=s():t.rxmask=s()}(self,(function(){return(()=>{"use strict";var t={d:(s,o)=>{for(var e in o)t.o(o,e)&&!t.o(s,e)&&Object.defineProperty(s,e,{enumerable:!0,get:o[e]})},o:(t,s)=>Object.prototype.hasOwnProperty.call(t,s),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},s={};t.r(s),t.d(s,{default:()=>o});class o{constructor(t={},s){this.options={mask:"",placeholderSymbol:"*",rxmask:[],value:"",cursorPos:0,allowedCharacters:".",maxMaskLength:0,trailing:!0},this.errors=[],this._output="",this._parsedValue="",this._prevValue="",this._isRemovingSymbols=!1,this._actualCursorPos=0,this._finalCursorPos=0,this.input=s,this.setOptions(t),this.input?this.onInput():this.parseMask()}get output(){return this._output}get parsedValue(){return this._parsedValue}get finalCursorPos(){return this._finalCursorPos}setOptions({mask:t="",placeholderSymbol:s="*",rxmask:o="",allowedCharacters:e=".",maxMaskLength:i="0",trailing:r="true",value:a="",cursorPos:n=-1}){this.options.mask=t,this.options.placeholderSymbol=s,this.options.rxmask=this.strToRxmask(o),this.options.allowedCharacters=e,this.options.maxMaskLength=Number(i),this.options.trailing="true"===r,this.options.value=a,this.options.cursorPos=n,0===this.options.rxmask.length&&(this.options.rxmask=this.options.mask.split("").map((t=>t===this.options.placeholderSymbol?"[^]":t)))}parseOptionsFromInput(){if(this.input){const t=this.input.dataset;this.options.mask=t.mask||this.options.mask,this.options.placeholderSymbol=t.placeholdersymbol||this.options.placeholderSymbol,this.options.rxmask=t.rxmask?this.strToRxmask(t.rxmask):this.options.rxmask,this.options.allowedCharacters=t.allowedcharacters||this.options.allowedCharacters,this.options.maxMaskLength=void 0!==t.maxmasklength?Number(t.maxmasklength):this.options.maxMaskLength,this.options.trailing=void 0!==t.trailing?"true"===t.trailing:this.options.trailing,this.options.value=this.input.value,this.options.cursorPos=this.input.selectionStart||0,0===this.options.rxmask.length&&(this.options.rxmask=this.options.mask.split("").map((t=>t===this.options.placeholderSymbol?"[^]":t)))}}onInput(){this.parseOptionsFromInput(),this.parseMask(),this.input&&(this.input.value=this.output,this.input.setSelectionRange(this.finalCursorPos,this.finalCursorPos))}parseMask(){this.errors=[];const t=this.parseOutMask(),s=this.parseRxmask(t);this._parsedValue=s,this._output=this.getOutput(s),this._prevValue=this._output}parseOutMask(){const{value:t,cursorPos:s,rxmask:o,placeholderSymbol:e,allowedCharacters:i}=this.options,r=t.length-this._prevValue.length;this._isRemovingSymbols=!(r>=0);let a=/./;try{a=new RegExp(i)}catch(t){console.error("Wrong regex for allowedCharacters!")}let n="";for(let i=s;i<t.length;i++)t[i]!==o[i-r]&&t[i]!==e&&t[i].match(a)&&(n+=t[i]);let l="";for(let i=0;i<s;i++)t[i]!==o[i]&&(t[i]!==e&&t[i].match(a)?l.length<o.filter((t=>t.match(/\[.*\]/))).length-n.length?l+=t[i]:this.errors.push({symbol:t[i],position:i,type:"length"}):t[i]===e||t[i].match(a)||this.errors.push({symbol:t[i],position:i,type:"allowedCharacters"}));return this._actualCursorPos=l.length,l+n}parseRxmask([...t]){const{rxmask:s}=this.options;let o="";const e=s.filter((t=>t.match(/\[.*\]/)));let i=0,r=0;for(;t.length>0&&i<t.length;){let s=/./;try{s=new RegExp(e[i])}catch(t){console.error("Wrong regex for rxmask!")}t[i].match(s)?(o+=t[i],i++):(this.errors.push({symbol:t[i],position:i+r,type:"rxmask"}),t.shift(),r++,this._actualCursorPos>i&&this._actualCursorPos--)}return o}getOutput([...t]){const{rxmask:s,maxMaskLength:o,placeholderSymbol:e,trailing:i}=this.options;this._finalCursorPos=0;let r="";const a=0===t.length,n=s.filter((t=>t.match(/\[.*\]/))).length===t.length;let l=!1;for(let h=0;h<s.length;h++)if(s[h].match(/\[.*\]/)){if(t.length>0)r+=t.shift();else{if(!(o>h))break;r+=e,l=!0}this._actualCursorPos>0&&this._finalCursorPos++,this._actualCursorPos--}else{if(!(o>h||t.length>0||(i||n)&&!l&&!this._isRemovingSymbols))break;r+=s[h],(!l&&a&&o>h||this._actualCursorPos>0||i&&0===this._actualCursorPos&&!this._isRemovingSymbols)&&this._finalCursorPos++}return r}strToRxmask(t){return(t||"").match(/(\[.*?\])|(.)/g)||[]}}return function(){const t=document.getElementsByClassName("rxmask");for(let s=0;s<t.length;s++){const e=t[s],i=new o({},e);e.oninput=()=>i.onInput()}}(),s})()}));